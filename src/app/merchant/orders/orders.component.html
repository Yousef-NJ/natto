<merchant-top-part></merchant-top-part>
<div class="container my-5 py-5">
  <div class="row mx-0 arabic-dir">
    <div class="col-md-3 border px-0 rounded h-100">
      <merchant-side-nav></merchant-side-nav>
    </div>
    <div class="col-md-9 mr-auto mt-5 mt-md-0 px-0 px-md-4">
      <div class="h5 mb-3 text-left">{{ "BAZZAR.ORDERS" | translate }}</div>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead class="text-center bg-light2">
            <th>
              {{ "BAZZAR.USER" | translate }}
            </th>
            <!-- <th>
              {{ "BAZZAR.ITEMS" | translate }}
            </th> -->
            <th>
              {{ "BAZZAR.DATE" | translate }}
            </th>
            <!-- <th>
              {{ "BAZZAR.PAYMENT_METHOD" | translate }}
            </th> -->
            <th>
              {{ "BAZZAR.TOTAL" | translate }}
            </th>
            <th>
              {{ "BAZZAR.STATUS" | translate }}
            </th>
            <th>
              {{ "BAZZAR.OPTIONS" | translate }}
            </th>
          </thead>
          <tbody class="text-center">
            <tr *ngFor="let order of orders">
              <td>{{ order.user.username }}</td>

              <td>{{ order.dateAndTime | date }}</td>
              <!-- <td>{{ order.paymentMethod }}</td> -->
              <td>{{ order.total }} {{ "BAZZAR.SAR" | translate }}</td>
              <td>
                <div class="col-auto my-1">
                  <button
                    class="btn btn-sm btn-primary"
                    (click)="changeOrderStatus('PROCCESSING', order.id)"
                    *ngIf="order.orderStatus == 'PENDING'"
                  >
                    {{ "BAZZAR.PENDING" | translate }}
                  </button>
                  <button
                    class="btn btn-sm btn-primary"
                    (click)="changeOrderStatus('DELIVERED', order.id)"
                    *ngIf="order.orderStatus == 'PROCCESSING'"
                  >
                    {{ "BAZZAR.PROCCESSING" | translate }}
                  </button>
                  <button
                    class="btn btn-sm btn-primary"
                    (click)="changeOrderStatus('SHIPPED', order.id)"
                    *ngIf="order.orderStatus == 'DELIVERED'"
                  >
                    {{ "BAZZAR.DELIVERED" | translate }}
                  </button>
                  <button
                    class="btn btn-sm btn-primary"
                    (click)="
                      changeOrderStatus('CANCELED_BY_MERCHANT', order.id)
                    "
                    *ngIf="order.orderStatus == 'SHIPPED'"
                  >
                    {{ "BAZZAR.SHIPPED" | translate }}
                  </button>
                  <button
                    class="btn btn-sm btn-primary"
                    (click)="
                      changeOrderStatus('CANCELED_BY_MERCHANT', order.id)
                    "
                    *ngIf="order.orderStatus == 'CANCELED_BY_MERCHANT'"
                  >
                    {{ "BAZZAR.CANCELED_BY_MERCHANT" | translate }}
                  </button>
                </div>
              </td>
              <td class="mt-2">
                <button
                  *ngIf="order.id != showenOrderId"
                  type="button"
                  class="btn btn-sm btn-outline-success"
                  (click)="showItems(order)"
                >
                  {{ "BAZZAR.VIEW_ITEMS" | translate }}
                </button>
                <button
                  *ngIf="order.id == showenOrderId"
                  type="button"
                  class="btn btn-sm btn-outline-success"
                  (click)="unshowItems(0)"
                >
                  {{ "BAZZAR.HIDE_ITEMS" | translate }}
                </button>
                <a
                  class="btn btn-success btn-sm mx-2"
                  routerLink="/view-order"
                  [queryParams]="{ id: order.id }"
                  >{{ "BAZZAR.ORDER_DETAILS" | translate }}
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="showOrderProducts" class="mb-4 pt-3 table-responsive">
        <table class="table table-bordered bg-light">
          <thead class="text-center">
            <th>
              {{ "BAZZAR.TITLE" | translate }}
            </th>

            <th>
              {{ "BAZZAR.PRICE" | translate }}
            </th>
            <th>
              {{ "BAZZAR.QUANTITY" | translate }}
            </th>
            <th>
              {{ "BAZZAR.TOTAL" | translate }}
            </th>
          </thead>
          <tbody class="text-center">
            <tr *ngFor="let product of selectedOrderProducts">
              <td>{{ product.product.titleEnglish }}</td>

              <td>{{ product.product.price }}</td>
              <td>{{ product.quantity }}</td>
              <td>
                {{ product.quantity * product.product.price }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
